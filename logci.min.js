/* logci - v0.4.2
 * https://github.com/zensh/logci
 * (c) 2014 Yan Qing <admin@zensh.com>
 * licensed MIT
 */
"use strict";!function(){function a(){}function b(a){return"object"==typeof a}function c(a){return"function"==typeof a}function d(a){return"string"==typeof a}function e(a){return"undefined"!=typeof a}function f(a,b,c){for(var d in a)m.call(a,d)&&b.call(c,a[d],d,a);return a}function g(a){r.host=a.host||r.host,r.bucket=a.bucket||r.bucket,r.token=a.token||r.token,r.reportHook=a.reportHook||r.reportHook,c(a.request)&&(r.request=a.request),b(a.slient)&&f(o,function(b,c){b=a.slient[c],e(b)&&(o[c]=b)}),b(a.report)&&f(p,function(b,c){b=a.report[c],e(b)&&(p[c]=b)})}function h(a,c){if(a){b(a)||(a=new Error(a)),a instanceof Error&&(a.name=a.name,a.message=a.message,a.stack=a.stack||a.description,delete a.domain),a.tag=c;try{a=JSON.stringify(a)}catch(e){}}return d(a)?a:""}function i(a){var b="";return a&&r.bucket&&r.token&&(b+=document&&"https:"===document.location.protocol?"https://":"http://",b+=r.host+"/ci?bucket="+r.bucket+"&token="+r.token,b+="&log="+encodeURIComponent(a)),b}function j(a){var b=new Image;b.onload=b.onerror=b.abort=function(){b=b.onload=b.onerror=b.abort=null},b.src=a}function k(a,b){c(r.reportHook)&&(a=r.reportHook(a,b)),a=i(h(a,b)),a&&(r.request||q)(a)}function l(a){if(c(a))try{a()}catch(d){l.error(d)}else b(a)&&g(a)}var m=Object.prototype.hasOwnProperty,n=console||{},o={},p={},q=a,r={host:"logci.com",bucket:"",token:"",slient:o,report:p};f(["log","info","warn","error"],function(b){n[b]=c(n[b])?n[b]:a,o[b]=!1,p[b]=!1,l[b]=function(){o[b]||n[b].apply(n,arguments),p[b]&&k(arguments[0],d(arguments[1])?arguments[1]:b)}}),o.globalError=p.globalError=!1,"object"==typeof window&&(q=j,window.logci=l,window.onerror=function(a,b,c,d,e){return p.globalError&&k(e||{name:(a.match(/\b([A-Z]){1}\w+Error|\bError/)||[])[0]||a,message:a,stack:a+"\n    at "+b+":"+c},"globalError"),o.globalError}),"object"==typeof module&&module.exports?(q=require("./lib/node_request.js"),module.exports=l):"function"==typeof define&&define.amd&&define(function(){return l})}();